<div *ngIf="new_user == undefined">
  <app-loading></app-loading>
</div>

<!-- IF NEW USER -->
<div [hidden]="!new_user == true">
  <div class="page">
    <div class="context">
      <span class="title"
        >Hey Hello! <br /><br />Let`s start with picking a Username.</span
      >

      <form class="box" action="" method="post" #form="ngForm">
        <div class="child-box">
          <p>username</p>
          <input
            required
            matInput
            #input="ngModel"
            [(ngModel)]="username"
            placeholder="username"
            type="text"
            (keydown.space)="$event.preventDefault()"
            name="username"
          />
          <div class="icon">
            <mat-icon *ngIf="username_check_error" class="clear"
              >clear</mat-icon
            >
            <mat-spinner
              *ngIf="username_check_loading"
              [diameter]="23"
            ></mat-spinner>
            <mat-icon *ngIf="username_check_success" class="done"
              >done_outline</mat-icon
            >
          </div>
        </div>

        <p class="username-error">{{ username_error }}</p>

        <div class="button-box">
          <input
            [disabled]="!form.valid"
            type="submit"
            name="submit"
            value="START"
            (click)="assignUsername()"
          />
        </div>
      </form>
    </div>
  </div>
</div>

<div *ngIf="new_user == false">
  <div class="page">
    <!-- ------------------ADD MORE MODAL-------------------->
    <input
      type="checkbox"
      name="dialog_state"
      id="dialog_state"
      [(ngModel)]="dialog_state_add_connection"
      class="dialog_state"
    />
    <div id="dialog">
      <label id="dlg-back" for="dialog_state"></label>
      <div id="dlg-wrap">
        <div class="add-content">
          <div class="page-title">Add New</div>
          <mat-divider></mat-divider>
          <!-- select social media part -->
          <div class="select">
            <div class="title">select a social media</div>
            <div class="select-box">
              <div class="select-box__current" tabindex="1">
                <div
                  class="select-box__value"
                  *ngFor="let social_media of all_social_media"
                >
                  <input
                    class="select-box__input"
                    type="radio"
                    id="{{ social_media._id }}"
                    name="social_media"
                    checked="checked"
                    (change)="selected_social_media_to_add = social_media"
                  />

                  <label class="select-box__input-text">
                    <div class="circle">
                      <img
                        src="../../../../assets/icons/social_media_icons/{{
                          social_media.icon_name
                        }}.svg"
                      />
                    </div>
                    <p>{{ social_media.name }}</p>
                  </label>
                </div>
                <img
                  class="select-box__icon"
                  src="http://cdn.onlinewebfonts.com/svg/img_295694.svg"
                  alt="Arrow Icon"
                  aria-hidden="true"
                />
              </div>
              <ul class="select-box__list">
                <li *ngFor="let social_media of all_social_media">
                  <label
                    class="select-box__option"
                    for="{{ social_media._id }}"
                    aria-hidden="aria-hidden"
                  >
                    <div class="circle">
                      <img
                        src="../../../../assets/icons/social_media_icons/{{
                          social_media.icon_name
                        }}.svg"
                      />
                    </div>
                    <p>{{ social_media.name }}</p>
                  </label>
                </li>
              </ul>
            </div>
          </div>

          <!-- media link text field -->
          <div class="profile-link">
            <div class="title">profile link</div>

            <div class="link-field">
              <input
                type="text"
                name="media-link"
                [(ngModel)]="new_connection_link"
                placeholder="copy link here..."
              />
            </div>
          </div>

          <div class="error">
            <span>{{ add_new_connection_error_message }}</span>
          </div>

          <!-- save link -->
          <div class="button-box">
            <a *ngIf="!add_new_connection_loading">
              <input
                (click)="addNewConnection()"
                type="submit"
                name="submit"
                value="SAVE"
              />
            </a>
            <div class="spinner" *ngIf="add_new_connection_loading">
              <mat-spinner [diameter]="25"></mat-spinner>
            </div>
          </div>
          <!-- cancel account -->
          <label for="dialog_state" *ngIf="!add_new_connection_loading">
            <div class="delete-account">
              <p>CANCEL</p>
            </div>
          </label>
        </div>
      </div>
    </div>

    <!-- ------------------EDIT SOCIAL MEDIA MODAL------------------ -->
    <input
      type="checkbox"
      name="dialog_state"
      id="dialog-${socialMedia}"
      class="dialog_state"
    />
    <div id="dialog">
      <label id="dlg-back" for="dialog-${socialMedia}"></label>
      <div id="dlg-wrap">
        <!-- social media icon -->
        <div class="icon-title">
          <img src="../../../../assets/icons/social_media_icons/twitter.svg" />
        </div>

        <!-- content part -->
        <div class="edit-link-content">
          <!-- title -->
          <div class="title">
            <p>Edit your Twitter profile link</p>
          </div>

          <!-- previous link -->
          <div class="previous-link">
            <div class="previous-title">previous link</div>
            <div class="link-field">
              <input
                type="text"
                name="media-link"
                value="www.link.com"
                disabled
              />
              <button
                type="button"
                class="copy-button"
                (click)="copyMessage('copiedmessage')"
              >
                <mat-icon>content_copy</mat-icon>
              </button>
            </div>
          </div>

          <!-- new link -->
          <div class="new-link">
            <div class="new-title">new link</div>
            <div class="link-field">
              <input
                type="text"
                name="media-link"
                placeholder="copy new link there..."
              />
            </div>
          </div>

          <!-- save link -->
          <div class="button-box">
            <label for="dialog_state">
              <a>
                <input type="submit" name="submit" value="SAVE" />
              </a>
            </label>
          </div>

          <!-- cancel account -->
          <label for="dialog-${socialMedia}">
            <div class="delete-account">
              <p>CANCEL</p>
            </div>
          </label>

          <mat-divider></mat-divider>

          <!-- delete link -->
          <div class="delete-button">
            <label for="dialog-${socialMedia}">
              <mat-icon>delete</mat-icon>
            </label>
          </div>
        </div>
      </div>
    </div>

    <!-- --------------------PROFILE-------------------- -->
    <main class="main_area">
      <div class="cicle"></div>

      <!-- background photo part -->
      <div class="background-image">
        <img class="back-image" src="{{ user.background_photo }}" />
        <div class="edit-photo">
          <img src="../../../../assets/icons/social_media_icons/edit.svg" />
        </div>
      </div>

      <!-- profile photo and favorites part -->
      <div class="profile-photo">
        <img class="photo" src="{{ user.profile_photo }}" />
        <div class="edit-photo">
          <img src="../../../../assets/icons/social_media_icons/edit.svg" />
        </div>
      </div>

      <!-- information, bio part -->
      <div class="information">
        <div class="name">
          <span style="text-align: center !important">{{ user.fullname }}</span>
          <mat-icon *ngIf="user.verified" class="icon-verify" aria-label="place"
            >verified_user</mat-icon
          >
        </div>

        <div class="country">
          <mat-icon
            *ngIf="user.country || user.city"
            class="icon-place"
            aria-label="place"
            >place</mat-icon
          >
          <p>
            {{ user.country }} {{ user.city && user.country ? "/" : "" }}
            {{ user.city }}
          </p>
        </div>

        <div class="job">
          <mat-icon *ngIf="user.job" class="icon-job" aria-label="place"
            >work</mat-icon
          >
          <p>{{ user.job }}</p>
        </div>
      </div>

      <!-- edit button -->

      <!-- divider -->
      <div class="divider">
        <div class="row">
          <div class="profile-copy">
            <div class="copy-button">
              <mat-icon>content_copy</mat-icon>
            </div>
            <span>Copy profile link</span>
          </div>

          <div class="see-profile">
            <div class="eye-button">
              <img src="../../../../assets/icons/social_media_icons/eye.svg" />
            </div>
            <span>Look from outside</span>
          </div>

          <div class="edit-links">
            <div class="edit-button-top">
              <div
                [ngClass]="{
                  'edit-close': edit_open == false,
                  'edit-open': edit_open == true
                }"
                (click)="changeEditState()"
              >
                <img
                  src="../../../../assets/icons/social_media_icons/edit.svg"
                />
              </div>
            </div>
            <span>Edit links</span>
          </div>
        </div>
        <hr />
      </div>

      <!-- links - main part  -->
      <div class="links">
        <!-- add more link -->
        <label for="dialog_state">
          <div class="box">
            <div class="child-box">
              <div class="circle">
                <img
                  src="../../../../assets/icons/social_media_icons/add.svg"
                />
              </div>
              <div class="link-name">
                <h1>Add more</h1>
              </div>
            </div>
          </div>
        </label>

        <!-- links -->
        <div class="box" *ngFor="let connection of connections">
          <app-link-box [connection]="connection"></app-link-box>

          <label for="dialog-${socialMedia}">
            <div
              (click)="openEditModal(number)"
              [ngClass]="{
                'edit-link-close': edit_open == false,
                'edit-link-open': edit_open == true
              }"
            >
              <img src="../../../../assets/icons/social_media_icons/edit.svg" />
            </div>
          </label>
        </div>
      </div>
    </main>
  </div>
</div>
